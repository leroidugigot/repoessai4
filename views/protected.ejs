<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Principale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        .parent {
            display: grid;
            grid-template-columns: repeat(2, 0.75fr) repeat(8, 1fr) repeat(2, 0.75fr);
            grid-template-rows: repeat(12, 1fr);
            grid-column-gap: 0px;
            grid-row-gap: 0px;
        }

        .div1 { grid-area: 1 / 1 / 2 / 3; }
        .div2 { grid-area: 1 / 3 / 2 / 9; }
        .div3 { grid-area: 1 / 9 / 2 / 13; }
        .div4 { grid-area: 2 / 3 / 3 / 11; }
        .div5 { grid-area: 2 / 1 / 4 / 3; }
        .div6 { grid-area: 4 / 1 / 11 / 3; }
        .div7 { grid-area: 11 / 1 / 13 / 3; }
        .div8 { grid-area: 2 / 11 / 9 / 13; }
        .div9 { grid-area: 9 / 11 / 11 / 13; }
        .div10 { grid-area: 11 / 11 / 13 / 13; }
        .div12 { grid-area: 2 / 3 / 13 / 11; }

        /* Masquer les barres de défilement */
        body::-webkit-scrollbar, 
        #mainContent::-webkit-scrollbar, 
        .div6::-webkit-scrollbar {
            display: none;
        }

        body {
            scrollbar-width: none;
        }

        .hidden {
            display: none;
        }

        body, #mainContent, .div6 {
            -ms-overflow-style: none;
        }

        #navbarHidden {
            transition: opacity 0.3s ease-in-out;
        }

        #navbarHidden.hidden {
            opacity: 0;
        }

        /* Style pour agrandir les divs en plein écran */
        .full-width {
            grid-column: 1 / 13;
        }

        #gptButton {
    position: relative;
    color: white;
    padding: 10px 15px;
    border-radius: 50%;
    font-size: 18px;
    cursor: pointer;
    background-color: #3b82f6;
}


        #gptButton.visible {
            display: block;
        }

        
    </style>
</head>
<body class="bg-gray-100 text-gray-900">

    <div class="parent h-screen">
        <!-- Div1 - Logo -->
        <div class="div1 bg-gray-800 flex justify-center border border-gray-700 h-full">
            <%- include('partials/logoSite') %>
        </div>

        <!-- Div2 - Navbar -->
        <div class="div2 bg-gray-800 border border-gray-700 h-full">
            <%- include('partials/navbar') %>
        </div>

        <!-- Div3 - Logbar -->
        <div class="div3 bg-gray-800 text-white flex items-center justify-center border border-gray-700 h-full">
            <%- include('partials/logbar', { user }) %>
            <!-- Bouton pour masquer les divs -->

        </div>

        <!-- Div4 - Navbar Hidden -->
        <div id="navbarHidden" class="div4 z-50 border border-gray-700 h-full">
            <%- include('partials/navbarHidden') %>

        </div>

        <!-- Div5 - Lesson Online -->
        <div id="div5" class="div5 bg-gray-800 border border-gray-700 h-full">
            <%- include('partials/lessonOnLine') %>
        </div>

        <!-- Div6 - Chapter List -->
        <div id="div6" class="div6 bg-gray-800 border border-gray-700 h-full">
            <%- include('partials/chapterList') %>
        </div>

        <!-- Div7 - Dashboard -->
        <div id="div7" class="div7 bg-gray-800 border border-gray-700 h-full">
            <%- include('partials/dashboarddiv') %>
        </div>

        <!-- Div8 - Connected Users -->
        <div id="div8" class="div8 bg-gray-800 border border-gray-700 h-full">
            <%- include('partials/connectedList') %>
        </div>

        <!-- Div9 - Referentials -->
        <div id="div9" class="div9 bg-gray-800 border border-gray-700 h-full">
            <%- include('partials/referentiels') %>
        </div>

        <!-- Div10 - Contact -->
        <div id="div10" class="div10 bg-gray-800 border border-gray-700 h-full relative">
            <%- include('partials/contact') %>
        </div>

        <!-- Div11 - Input GPT -->
        <div id="gptInput" class="div12 hidden overflow-auto h-full">
            <%- include('partials/inputgpt') %> <!-- Contenu GPT ici -->
        </div>

        <!-- Div12 - Main Content -->
        <div id="mainContent" class="div12 border border-gray-700 overflow-y-auto h-full">
            <%- include('partials/contenus') %>
        </div>  
    </div>

    <script>
        // Gestion de l'affichage de `div11` (gptInput) et `div12` (mainContent)
        document.getElementById('gptButton').addEventListener('click', function () {
            const gptInput = document.getElementById('gptInput');
            const mainContent = document.getElementById('mainContent');
    
            // Alterner la visibilité entre div11 et div12
            mainContent.classList.toggle('hidden');
            gptInput.classList.toggle('hidden');
    
            // Agrandir la div affichée
            if (gptInput.classList.contains('hidden')) {
                mainContent.classList.toggle('full-width', !mainContent.classList.contains('hidden'));
            } else {
                gptInput.classList.toggle('full-width', !gptInput.classList.contains('hidden'));
            }
        });
    
        // Script modifié pour contrôler la visibilité de navbarHidden
        let lastScrollTop = 0;
        const navbar = document.getElementById('navbarHidden');
        const mainContent = document.getElementById('mainContent');
    
        function handleScroll() {
            let scrollTop = mainContent.scrollTop;
            if (scrollTop > lastScrollTop) {
                // Défilement vers le bas : masquer `navbarHidden`
                navbar.classList.add('hidden');
            } else {
                // Défilement vers le haut : afficher `navbarHidden`
                navbar.classList.remove('hidden');
            }
            lastScrollTop = scrollTop;
        }
    
        // Attacher l'événement de défilement
        mainContent.addEventListener('scroll', handleScroll);
    
        // Gestion du bouton toggleButton
        document.getElementById('toggleButton').addEventListener('click', function () {
            const divsToHide = ['div5', 'div6', 'div7', 'div8', 'div9', 'div10'];
            const gptInput = document.getElementById('gptInput');
    
            // Masquer les divs 5 à 10
            divsToHide.forEach(divId => {
                const div = document.getElementById(divId);
                if (div) {
                    div.classList.toggle('hidden');
                }
            });
    
            // Agrandir les divs 4 et 12 (ou 11)
            const allHidden = divsToHide.every(divId => document.getElementById(divId).classList.contains('hidden'));
            navbar.classList.toggle('full-width', allHidden);
            mainContent.classList.toggle('full-width', allHidden);
            gptInput.classList.toggle('full-width', allHidden);
    
            // Afficher ou masquer le bouton GPT
            document.getElementById('gptButton').classList.toggle('visible', allHidden);
        });
    </script>
    
</body>
</html>
